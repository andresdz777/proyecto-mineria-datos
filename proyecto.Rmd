---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}

library(arules)

data <- read.csv('violenciav2.csv', sep=",")
data <- subset(data, VIOLENCIA_ID != 99999)

data



datagastos <- read.csv('gastos.csv', sep=",")

datamigracion <- read.csv('migracion.csv', sep=",")
datamigracion2 <- read.csv('migracion2.csv', sep=",")

```



```{r}

datagastos <- datagastos[ , !(names(datagastos) %in% c("PEA"))]
datagastos <- datagastos[ , !(names(datagastos) %in% c("POCUPA"))]
datagastos <- datagastos[ , !(names(datagastos) %in% c("PEI"))]

datamsc <- subset(datagastos, P13B05 == 1)

datamsc <- subset(datamsc, DOMINIO == 3)

datamsc <- subset(datamsc, POBREZA == 1)

datamsc2 <- datamsc[, c(5,10,11,13)]

reglas <- apriori(datamsc2, parameter = list(support=0.3, confidence=0.3))

inspect(head(sort(reglas, by = "lift", decreasing = TRUE), 50))

datamsc2

```
```{r}

datagastos <- datagastos[ , !(names(datagastos) %in% c("PEA"))]
datagastos <- datagastos[ , !(names(datagastos) %in% c("POCUPA"))]
datagastos <- datagastos[ , !(names(datagastos) %in% c("PEI"))]

datamsc <- subset(datagastos, P13B05 == 1)

datamsc <- subset(datamsc, DOMINIO == 1)

datamsc <- subset(datamsc, POBREZA == 3)

datamsc2 <- datamsc[, c(5,10,13)]

reglas <- apriori(datamsc2, parameter = list(support=0.3, confidence=0.3))

inspect(head(sort(reglas, by = "lift", decreasing = TRUE), 20))

datamsc


```

```{r}



datamigracion <- datamigracion[ , !(names(datamigracion) %in% c("PEA"))]
datamigracion <- datamigracion[ , !(names(datamigracion) %in% c("POCUPA"))]
datamigracion <- datamigracion[ , !(names(datamigracion) %in% c("PEI"))]

datamsc <- subset(datamigracion, P01I01A == 1)


datamsc2 <- datamsc[, c(1,10)]

reglas <- apriori(datamsc2, parameter = list(support=0.3, confidence=0.3))

inspect(head(sort(reglas, by = "lift", decreasing = TRUE), 20))

datamsc2


```

```{r}

datamigracion2 <- datamigracion2[ , !(names(datamigracion2) %in% c("PEA"))]
datamigracion2 <- datamigracion2[ , !(names(datamigracion2) %in% c("POCUPA"))]
datamigracion2 <- datamigracion2[ , !(names(datamigracion2) %in% c("PEI"))]

datamsc <- subset(datamigracion2, DOMINIO == 1)

datamsc3 <- subset(datamsc, POBREZA == 3)

datamsc2 <- datamsc3[, c(10, 11,13)]

reglas <- apriori(datamsc2, parameter = list(support=0.3, confidence=0.3))

inspect(head(sort(reglas, by = "lift", decreasing = TRUE), 60))

datamsc3

```





```{r}

datamsc <- subset(data, P02A04B == 6)

datamsc2 <- datamsc[, c(10,11,23)]

reglas <- fim4r(datamsc2, method = "fpgrowth", target = "rules", supp = .2, conf = .2)

inspect(head(sort(reglas, by = "lift"), 20))
```
```{r}

#FILA 9 LO QUE TIENE MAYOR CONTEO DE VIOLENCIA A LAS PERSONAS SON  AMENAZAS YA SEA POR FAMILIARES O DESCONOCIDOS YA SEA EN CASA O EN EL TRABAJO

datamsc <- subset(data, P02A02 >= 10)

datamsc2 <- datamsc[, c(10,15, 16)]

reglas <- fim4r(datamsc2, method = "fpgrowth", target = "rules", supp = .2, conf = .2)

inspect(reglas[])
```

```{r}

datamsc <- subset(data, POBREZA == 3)

datamsc2 <- datamsc[, c(10,1,13, 15, 16)]

reglas <- fim4r(datamsc2, method = "fpgrowth", target = "rules", supp = .1, conf = .1)

inspect(reglas[])
```
```{r}


datamsc <- subset(data, P02A01 == 1)

datamsc2 <- datamsc[, c(1,10, 23)]

reglas <- fim4r(datamsc2, method = "fpgrowth", target = "rules", supp = .2, conf = .2)

inspect(head(sort(reglas, by = "lift"), 10))
```
